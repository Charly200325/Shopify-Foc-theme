<div class="reviews">
  <div class="reviews__header">
    <p class="subheading">★★★★★ +10 000 CLIENTES SATISFAITES</p>
    <h2>Ce Que Nos Clients Disent de JawLift™</h2>
  </div>

  <div class="reviews__slider" id="reviewSlider">
    {% for block in section.blocks %}
    <div class="review-card">
      <div class="review-top">
        <div class="review-stars"> 
          {% assign rating = block.settings.rating | default: 5 %}
          {% for star in (1..rating) %}
          <svg class="icon-star" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="#333">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.948a1 1 0 00.95.69h4.15c.969 0 1.371 1.24.588 1.81l-3.36 2.44a1 1 0 00-.364 1.118l1.286 3.947c.3.921-.755 1.688-1.54 1.118L10 13.011l-3.36 2.439c-.784.57-1.838-.197-1.54-1.118l1.286-3.947a1 1 0 00-.364-1.118L2.662 9.375c-.784-.57-.38-1.81.588-1.81h4.15a1 1 0 00.95-.69l1.286-3.948z"></path>
          </svg>
          {% endfor %}
        </div>
        <p class="review-name">{{ block.settings.name }}</p>
      </div>
      <p class="review-text">{{ block.settings.review_text }}</p>
    </div>
    {% endfor %}
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const slider = document.getElementById("reviewSlider");
    let isDown = false;
    let startX;
    let scrollLeft;

    function autoScroll() {
      slider.scrollBy({ left: 350, behavior: "smooth" });
      if (slider.scrollLeft + slider.clientWidth >= slider.scrollWidth) {
        slider.scrollTo({ left: 0, behavior: "smooth" });
      }
    }
    setInterval(autoScroll, 3000);

    slider.addEventListener("mousedown", (e) => {
      isDown = true;
      startX = e.pageX - slider.offsetLeft;
      scrollLeft = slider.scrollLeft;
    });

    slider.addEventListener("mouseleave", () => {
      isDown = false;
    });

    slider.addEventListener("mouseup", () => {
      isDown = false;
    });

    slider.addEventListener("mousemove", (e) => {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - slider.offsetLeft;
      const walk = (x - startX) * 2;
      slider.scrollLeft = scrollLeft - walk;
    });

    slider.addEventListener("wheel", (e) => {
      e.preventDefault();
      slider.scrollLeft += e.deltaY;
    });
  });
</script>

<style>
.reviews {
  background-color: #fde4e6;
  padding: 40px 0;
  text-align: center;
  position: relative;
}

.subheading {
  font-size: 18px;
  color: #333;
  margin-bottom: 10px;
}

h2 {
  font-size: 24px;
  color: #555;
  margin-bottom: 30px;
}

.reviews__slider {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  scrollbar-width: none;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 10px;
  cursor: grab;
}

.reviews__slider::-webkit-scrollbar {
  display: none;
}

.review-card {
  background: #F3F3F3;
  border-radius: 10px;
  padding: 15px;
  margin: 0 10px;
  flex: 0 0 300px;
  height: auto;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  scroll-snap-align: center;
  text-align: left;
}

.review-top {
  display: flex;
  align-items: center;
  gap: 10px;
}

.review-stars {
  display: flex;
}

.icon-star {
  width: 16px;
  height: 16px;
}

.review-name {
  font-weight: bold;
}

.review-text {
  font-size: 14px;
  margin-top: 5px;
}

@media (max-width: 768px) {
  .reviews__slider {
    padding: 10px;
  }

  .review-card {
    flex: 0 0 100%;
    margin: 0 5px;
  }
}
</style>
